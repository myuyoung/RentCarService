<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이미지 테스트</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        img { max-width: 300px; margin: 10px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>이미지 URL 테스트</h1>
    
    <div class="test-section">
        <h2>데이터베이스에 저장된 이미지 직접 테스트</h2>
        <p>relativePath: 2025/08/13/c0d84d15-39de-4c00-9a2d-fab1e69bfd7a.png</p>
        <img src="/images/2025/08/13/c0d84d15-39de-4c00-9a2d-fab1e69bfd7a.png" alt="테스트 이미지 1" />
        
        <p>relativePath: 2025/08/13/dafa47ab-f20f-49e2-8982-86d66c47eb6a.png</p>
        <img src="/images/2025/08/13/dafa47ab-f20f-49e2-8982-86d66c47eb6a.png" alt="테스트 이미지 2" />
    </div>

    <div class="test-section">
        <h2>API 테스트</h2>
        <button id="test-api">차량 등록 신청 목록 조회</button>
        <div id="api-result"></div>
        
        <button id="test-detail-api">특정 신청 상세 조회 (이미지 있는 것)</button>
        <div id="detail-result"></div>
    </div>

    <script>
        // API 테스트
        document.getElementById('test-api').addEventListener('click', async function() {
            try {
                const token = localStorage.getItem('userInfo') ? JSON.parse(localStorage.getItem('userInfo')).token : null;
                const response = await fetch('/api/admin/car-submissions', {
                    method: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                document.getElementById('api-result').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (error) {
                document.getElementById('api-result').innerHTML = '<div style="color: red;">오류: ' + error.message + '</div>';
            }
        });

        // 상세 API 테스트  
        document.getElementById('test-detail-api').addEventListener('click', async function() {
            try {
                const token = localStorage.getItem('userInfo') ? JSON.parse(localStorage.getItem('userInfo')).token : null;
                const response = await fetch('/api/admin/car-submissions/2477e3e2-34a2-4afe-9f08-cef613fdfe6e', {
                    method: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                document.getElementById('detail-result').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                
                // 이미지 URL이 있다면 표시
                if (data.success && data.data && data.data.imageUrls && data.data.imageUrls.length > 0) {
                    const imageHtml = data.data.imageUrls.map(url => 
                        `<img src="${url}" alt="API 이미지" style="max-width: 200px; margin: 5px;" />`
                    ).join('');
                    document.getElementById('detail-result').innerHTML += '<div><h3>API에서 받은 이미지들:</h3>' + imageHtml + '</div>';
                }
            } catch (error) {
                document.getElementById('detail-result').innerHTML = '<div style="color: red;">오류: ' + error.message + '</div>';
            }
        });
    </script>
</body>
</html>
